#!/bin/zsh

IFS=${DELIMITER_ENDL}
INPUT_STDIN=($(get-stdin &))

    
BOLD='%b'
NL=$'\n'
KF='%k%f'
    
CNTR=0

_handle-args() {

    for param in ${@}
    do
        #echo "Begin param:${param}: CNTR: ${CNTR}"
        if startsWithDash ${param}
        then
            ([[ ${param/-/} = "-bold" ]] || [[ ${param/-/} = "b" ]]) && BOLD='%B' && ((CNTR++)) #&& echo bold
            ([[ ${param/-/} = "-newline" ]] || [[ ${param/-/} = "n" ]]) && NL='' && ((CNTR++)) #&& echo newline
        else
            ([[ CNTR -ge 0 ]] && [[ CNTR -le 2 ]]) && [[ -z "${TEXT}" ]] && TEXT="${param}"  && ((CNTR++)) #&& echo text
        fi
        #echo "end param:${param}: CNTR: ${CNTR}"
    done
    shift ${CNTR}
}

_ecko() {


            
    TEXT="${1}" # && ((CNTR++)) #&& echo text
    shift

    #_handle-args

    FGC=''
    BGC=''

    [[ -n ${1} ]] && isNumeric ${1} && FGC="%F{${1}}"
    [[ -n ${2} ]] && isNumeric ${2} && BGC="%K{${2}}"
    [[ -n ${3} ]] && isNumeric ${3} && KF=''

    print -Pn "${FGC}${BGC}${BOLD}${TEXT}${KF}" ${NL} #  > /dev/stdin
}

if [[ -n ${INPUT_STDIN} ]]
then
    for line in ${INPUT_STDIN}
    do
        _ecko ${line} ${@}
    done
else
    _ecko ${@}
fi


